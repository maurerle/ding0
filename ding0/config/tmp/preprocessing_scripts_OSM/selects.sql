-- FALLENBRUNNEN

-- buildings w amenities


select bwa.* from buildings_with_amenities bwa
where st_intersects(bwa.geometry_amenity, ST_GeomFromText('POLYGON((4281997.41869224 2732185.07316504,4281998.88075016 2732195.14230024,4281998.01576282 2732213.92516569,4281993.61512521 2732232.20571892,4281985.83757831 2732249.32453903,4281974.9636758 2732264.66411145,4281961.38566396 2732277.67110312,4281945.59333238 2732287.87632242,4281928.15634618 2732294.91164401,4281909.70369689 2732298.52328794,4281899.89836158 2732299.48902918,4281899.80062908 2732299.51867601,4281899.71055828 2732299.56681985,4281899.63161057 2732299.63161056,4281899.56681985 2732299.71055828,4281899.51867601 2732299.80062907,4281899.48902918 2732299.89836158,4281899 2732304.86355813,4281899 2732400,4281897.32744326 2732418.12094891,4281892.36628708 2732435.62960862,4281884.28416412 2732451.93437859,4281873.35416141 2732466.48433653,4281859.9455931 2732478.78785356,4281844.51152164 2732488.42920582,4281827.57344925 2732495.08262142,4281809.70369689 2732498.52328794,4281799.89836158 2732499.48902918,4281799.80062908 2732499.51867601,4281799.71055828 2732499.56681985,4281799.63161057 2732499.63161056,4281799.56681985 2732499.71055828,4281799.51867601 2732499.80062907,4281799.48902918 2732499.89836158,4281799 2732504.86355813,4281799 2732595.13644187,4281799.48902918 2732600.10163842,4281799.51867601 2732600.19937093,4281799.56681985 2732600.28944172,4281799.63161057 2732600.36838944,4281799.71055828 2732600.43318015,4281799.80062908 2732600.48132399,4281799.89836158 2732600.51097082,4281804.86355813 2732601,4281895.13644187 2732601,4281900.10163842 2732600.51097082,4281905.52122057 2732598.86695855,4281911.05481399 2732596.52729832,4281928.59387086 2732592.63659849,4281946.54726737 2732591.97962414,4281964.32378142 2732594.57801004,4281976.90843708 2732598.84446971,4281979.1233037 2732599.34140188,4281979.22510906 2732599.34381457,4281983.25367623 2732598.63851471,4281986.23346757 2732597.64747867,4282050.98250327 2732572.50907546,4282052.67774805 2732571.81526867,4282054.35848586 2732571.09153676,4282056.02745182 2732570.33670197,4282088.89368292 2732554.74796176,4282092.06044497 2732553.10647598,4282095.15571594 2732551.36064439,4282098.19866948 2732549.49965245,4282146.71482044 2732517.41992253,4282163.72714343 2732508.41445931,4282182.16056123 2732502.87130051,4282201.31821599 2732501,4282295.13644187 2732501,4282300.10163842 2732500.51097082,4282300.19937092 2732500.48132399,4282300.28944172 2732500.43318015,4282300.36838943 2732500.36838944,4282300.43318015 2732500.28944172,4282300.48132399 2732500.19937093,4282300.51097082 2732500.10163842,4282301 2732495.13644187,4282301 2732494.32793279,4282303.03682233 2732474.34938989,4282309.06347831 2732455.19292259,4282318.83198354 2732437.6467798,4282331.9403843 2732422.43294888,4282347.84929708 2732410.17744743,4282365.90410312 2732401.38456392,4282385.3618846 2732396.41610726,4282405.42199416 2732395.47651914,4282425.25899991 2732398.60446167,4282444.0566502 2732405.67122648,4282449.67425281 2732408.46281173,4282449.77100851 2732408.48861632,4282453.94272214 2732408.73951837,4282457.16272239 2732408.44779934,4282577.86753831 2732391.37758309,4282581.11134693 2732390.74380087,4282585.17543061 2732389.25874244,4282585.25573357 2732389.20837591,4282585.32378301 2732389.14238633,4282585.37659329 2732389.06366895,4282585.41184738 2732388.97567747,4282586.14909619 2732384.71203595,4282586.19482672 2732381.40720873,4282581.60244345 2732262.57045071,4282582.53680519 2732244.65468309,4282586.68904681 2732227.20169909,4282593.92281594 2732210.78462428,4282598.15490424 2732204.55179615,4282600.48132399 2732200.19937093,4282600.51097082 2732200.10163842,4282601 2732195.13644187,4282601 2732104.86355813,4282600.51097082 2732099.89836158,4282600.48132399 2732099.80062907,4282600.43318015 2732099.71055828,4282600.36838943 2732099.63161056,4282600.28944172 2732099.56681985,4282600.19937092 2732099.51867601,4282600.10163842 2732099.48902918,4282595.13644187 2732099,4282504.86355813 2732099,4282499.89836158 2732099.48902918,4282499.80062908 2732099.51867601,4282499.71055828 2732099.56681985,4282499.63161057 2732099.63161056,4282499.56681985 2732099.71055828,4282499.51867601 2732099.80062907,4282498.35223764 2732103.64586105,4282495.68536327 2732116.63952152,4282487.45377848 2732135.52967954,4282475.4900696 2732152.30664972,4282460.31252617 2732166.24362334,4282442.57866683 2732176.73682548,4282423.05675446 2732183.33167163,4282415.8951919 2732184.94459055,4282411.41722228 2732186.84480967,4282402.2575052 2732191.66318818,4282383.91324626 2732197.14848334,4282364.85616923 2732199,4282304.86355813 2732199,4282299.89836158 2732199.48902918,4282299.80062908 2732199.51867601,4282299.71055828 2732199.56681985,4282299.63161057 2732199.63161056,4282294.90222514 2732205.39438339,4282281.00817311 2732219.25746108,4282264.65228409 2732230.10709237,4282246.47742844 2732237.51683104,4282227.1979713 2732241.19543635,4282207.57169427 2732240.99832021,4282188.37001077 2732236.93323032,4282170.34764553 2732229.15994555,4282154.21297 2732217.98399591,4282140.60015974 2732203.84465357,4282130.04426807 2732187.29766726,4282122.9601957 2732168.99341848,4282117.39278732 2732148.8749034,4282116.37935611 2732145.8336756,4282114.43388927 2732142.06657956,4282114.37280666 2732141.99157426,4282114.29762866 2732141.93070433,4282114.21155693 2732141.88656208,4282114.11825708 2732141.86102743,4282114.02170253 2732141.85518784,4282109.82721968 2732142.47338469,4282106.76606956 2732143.42494621,4282073.36180495 2732155.73464355,4282070.54683642 2732156.92501199,4282067.17110368 2732158.95342197,4282065.9512084 2732160.04307885,4282050.6794854 2732171.25385801,4282033.55190822 2732179.35035063,4282015.19567907 2732184.03606773,4281997.41869224 2732185.07316504))',3035))



SELECT bwa.osm_id_amenity, bwa.osm_id_building, bwa.building, bwa.area, bwa.geometry_building, bwa.geometry_amenity, bwa.geo_center, bwa."name", bwa.building_tags, bwa.amenity_tags, bwa.n_amenities_inside, bwa.n_apartments, array_agg( ST_x(bwa.dumppoints)||', '||ST_y(bwa.dumppoints)) as point_list_poly
FROM
    (SELECT bwa.*, (ST_dumppoints(bwa.geometry_building)).geom as dumppoints
    from buildings_with_amenities bwa
    where st_intersects(bwa.geometry_amenity, ST_GeomFromText('POLYGON ((9.444757321553571 47.6640820372137, 9.44469147049122 47.6642370363376, 9.442746638836271 47.6675223477341, 9.44273323863089 47.6675486765942, 9.44272335456083 47.6675846924473, 9.44272337322715 47.6675856076278, 9.44272365679015 47.667586502615, 9.442724194246059 47.6675873426787, 9.442724964738851 47.6675880952201, 9.442725938369239 47.6675887310364, 9.442771524985689 47.6676085195463, 9.442809078141879 47.6676199425426, 9.443599054706221 47.6678292167847, 9.44364298889086 47.6678391758214, 9.44369319196211 47.6678454078942, 9.443694609235431 47.6678454056071, 9.44369600193242 47.6678452280573, 9.443697323077419 47.6678448812336, 9.443698528108349 47.6678443768344, 9.443744598701199 47.6678160313241, 9.443795360184319 47.6677784822092, 9.443991191770809 47.6676599114601, 9.44421793991903 47.667570002951, 9.44446657647225 47.667512336406, 9.44472720190474 47.6674892078198, 9.444989439424219 47.6675015380556, 9.445052589744799 47.6675088406224, 9.445117064489731 47.6675174206873, 9.445183601261711 47.6675274468952, 9.44523747329856 47.6675300193568, 9.445238809309229 47.6675299032106, 9.4452400852424 47.6675296113077, 9.445241251079061 47.667529155091, 9.445242261116221 47.6675285524453, 9.445243075758549 47.6675278269953, 9.44524366307046 47.6675270071801, 9.445257172339209 47.6674916444378, 9.44526138400154 47.6674643786881, 9.44526635876986 47.6674027181877, 9.44527842375639 47.6673216144847, 9.44528702520314 47.6672820624034, 9.445343690252869 47.6671237851091, 9.44544200701166 47.6669751340207, 9.445578690330031 47.6668410756375, 9.445606929899901 47.666818179473, 9.445637520256669 47.6667867600046, 9.445694232828229 47.6667392820943, 9.445718033000571 47.6667110812337, 9.445816550854619 47.6665782840333, 9.445885789521761 47.6664961432372, 9.44592142419992 47.6664586450851, 9.44609642847751 47.6663115101204, 9.446313359526091 47.6661926345661, 9.44656247099808 47.6661073591621, 9.4468325709589 47.6660595150674, 9.447111524661491 47.6660512517601, 9.44717730910928 47.6660540322315, 9.447316189895529 47.6660649297759, 9.44753610831893 47.6660902456686, 9.44758112940486 47.6660938580278, 9.44767071891042 47.6660918313842, 9.447684852061499 47.6660900296329, 9.44774691292624 47.6660795923001, 9.4479881800759 47.6660547725018, 9.448232085468209 47.6660604809193, 9.448470258112661 47.6660965216365, 9.448560914386359 47.6661163562617, 9.44857404167368 47.6661182063231, 9.448691583060739 47.6661430580836, 9.44873711713312 47.6661476818212, 9.44936429835351 47.6661892570172, 9.44940607834077 47.66619064719, 9.44946122599818 47.6661870380657, 9.449463401923399 47.6661858503929, 9.449498075077059 47.6661578721339, 9.449520006942709 47.6661337837734, 9.45042894326825 47.6650175089795, 9.45044714891934 47.6649921250378, 9.450463499380801 47.6649559172176, 9.450463614247271 47.6649550512483, 9.450463463599689 47.664954187754, 9.450463053866351 47.6649533635807, 9.45046240253088 47.6649526138965, 9.450461537386341 47.6649519706911, 9.450460495349169 47.6649514614106, 9.45040935260457 47.6649360626301, 9.45036907619812 47.664928709451, 9.447377834868041 47.6644933952575, 9.447343269935271 47.6644880343118, 9.44730847614896 47.6644823034133, 9.44727413690042 47.6644763151236, 9.444928887305879 47.6640444576946, 9.444886220360861 47.6640381906818, 9.444829205115131 47.6640359557828, 9.4448279422305 47.6640360849357, 9.44482674602855 47.6640363876611, 9.44482566804831 47.6640368509158, 9.444757321553571 47.6640820372137))',4326))
) AS bwa
group by bwa.osm_id_amenity, bwa.osm_id_building, bwa.building, bwa.area, bwa.geometry_building, bwa.geometry_amenity, bwa.geo_center, bwa."name", bwa.building_tags, bwa.amenity_tags, bwa.n_amenities_inside, bwa.n_apartments;


-- buildings w/o amenities

select * from buildings_without_amenities bwa
where st_intersects(bwa.geometry, ST_GeomFromText('POLYGON((4281997.41869224 2732185.07316504,4281998.88075016 2732195.14230024,4281998.01576282 2732213.92516569,4281993.61512521 2732232.20571892,4281985.83757831 2732249.32453903,4281974.9636758 2732264.66411145,4281961.38566396 2732277.67110312,4281945.59333238 2732287.87632242,4281928.15634618 2732294.91164401,4281909.70369689 2732298.52328794,4281899.89836158 2732299.48902918,4281899.80062908 2732299.51867601,4281899.71055828 2732299.56681985,4281899.63161057 2732299.63161056,4281899.56681985 2732299.71055828,4281899.51867601 2732299.80062907,4281899.48902918 2732299.89836158,4281899 2732304.86355813,4281899 2732400,4281897.32744326 2732418.12094891,4281892.36628708 2732435.62960862,4281884.28416412 2732451.93437859,4281873.35416141 2732466.48433653,4281859.9455931 2732478.78785356,4281844.51152164 2732488.42920582,4281827.57344925 2732495.08262142,4281809.70369689 2732498.52328794,4281799.89836158 2732499.48902918,4281799.80062908 2732499.51867601,4281799.71055828 2732499.56681985,4281799.63161057 2732499.63161056,4281799.56681985 2732499.71055828,4281799.51867601 2732499.80062907,4281799.48902918 2732499.89836158,4281799 2732504.86355813,4281799 2732595.13644187,4281799.48902918 2732600.10163842,4281799.51867601 2732600.19937093,4281799.56681985 2732600.28944172,4281799.63161057 2732600.36838944,4281799.71055828 2732600.43318015,4281799.80062908 2732600.48132399,4281799.89836158 2732600.51097082,4281804.86355813 2732601,4281895.13644187 2732601,4281900.10163842 2732600.51097082,4281905.52122057 2732598.86695855,4281911.05481399 2732596.52729832,4281928.59387086 2732592.63659849,4281946.54726737 2732591.97962414,4281964.32378142 2732594.57801004,4281976.90843708 2732598.84446971,4281979.1233037 2732599.34140188,4281979.22510906 2732599.34381457,4281983.25367623 2732598.63851471,4281986.23346757 2732597.64747867,4282050.98250327 2732572.50907546,4282052.67774805 2732571.81526867,4282054.35848586 2732571.09153676,4282056.02745182 2732570.33670197,4282088.89368292 2732554.74796176,4282092.06044497 2732553.10647598,4282095.15571594 2732551.36064439,4282098.19866948 2732549.49965245,4282146.71482044 2732517.41992253,4282163.72714343 2732508.41445931,4282182.16056123 2732502.87130051,4282201.31821599 2732501,4282295.13644187 2732501,4282300.10163842 2732500.51097082,4282300.19937092 2732500.48132399,4282300.28944172 2732500.43318015,4282300.36838943 2732500.36838944,4282300.43318015 2732500.28944172,4282300.48132399 2732500.19937093,4282300.51097082 2732500.10163842,4282301 2732495.13644187,4282301 2732494.32793279,4282303.03682233 2732474.34938989,4282309.06347831 2732455.19292259,4282318.83198354 2732437.6467798,4282331.9403843 2732422.43294888,4282347.84929708 2732410.17744743,4282365.90410312 2732401.38456392,4282385.3618846 2732396.41610726,4282405.42199416 2732395.47651914,4282425.25899991 2732398.60446167,4282444.0566502 2732405.67122648,4282449.67425281 2732408.46281173,4282449.77100851 2732408.48861632,4282453.94272214 2732408.73951837,4282457.16272239 2732408.44779934,4282577.86753831 2732391.37758309,4282581.11134693 2732390.74380087,4282585.17543061 2732389.25874244,4282585.25573357 2732389.20837591,4282585.32378301 2732389.14238633,4282585.37659329 2732389.06366895,4282585.41184738 2732388.97567747,4282586.14909619 2732384.71203595,4282586.19482672 2732381.40720873,4282581.60244345 2732262.57045071,4282582.53680519 2732244.65468309,4282586.68904681 2732227.20169909,4282593.92281594 2732210.78462428,4282598.15490424 2732204.55179615,4282600.48132399 2732200.19937093,4282600.51097082 2732200.10163842,4282601 2732195.13644187,4282601 2732104.86355813,4282600.51097082 2732099.89836158,4282600.48132399 2732099.80062907,4282600.43318015 2732099.71055828,4282600.36838943 2732099.63161056,4282600.28944172 2732099.56681985,4282600.19937092 2732099.51867601,4282600.10163842 2732099.48902918,4282595.13644187 2732099,4282504.86355813 2732099,4282499.89836158 2732099.48902918,4282499.80062908 2732099.51867601,4282499.71055828 2732099.56681985,4282499.63161057 2732099.63161056,4282499.56681985 2732099.71055828,4282499.51867601 2732099.80062907,4282498.35223764 2732103.64586105,4282495.68536327 2732116.63952152,4282487.45377848 2732135.52967954,4282475.4900696 2732152.30664972,4282460.31252617 2732166.24362334,4282442.57866683 2732176.73682548,4282423.05675446 2732183.33167163,4282415.8951919 2732184.94459055,4282411.41722228 2732186.84480967,4282402.2575052 2732191.66318818,4282383.91324626 2732197.14848334,4282364.85616923 2732199,4282304.86355813 2732199,4282299.89836158 2732199.48902918,4282299.80062908 2732199.51867601,4282299.71055828 2732199.56681985,4282299.63161057 2732199.63161056,4282294.90222514 2732205.39438339,4282281.00817311 2732219.25746108,4282264.65228409 2732230.10709237,4282246.47742844 2732237.51683104,4282227.1979713 2732241.19543635,4282207.57169427 2732240.99832021,4282188.37001077 2732236.93323032,4282170.34764553 2732229.15994555,4282154.21297 2732217.98399591,4282140.60015974 2732203.84465357,4282130.04426807 2732187.29766726,4282122.9601957 2732168.99341848,4282117.39278732 2732148.8749034,4282116.37935611 2732145.8336756,4282114.43388927 2732142.06657956,4282114.37280666 2732141.99157426,4282114.29762866 2732141.93070433,4282114.21155693 2732141.88656208,4282114.11825708 2732141.86102743,4282114.02170253 2732141.85518784,4282109.82721968 2732142.47338469,4282106.76606956 2732143.42494621,4282073.36180495 2732155.73464355,4282070.54683642 2732156.92501199,4282067.17110368 2732158.95342197,4282065.9512084 2732160.04307885,4282050.6794854 2732171.25385801,4282033.55190822 2732179.35035063,4282015.19567907 2732184.03606773,4281997.41869224 2732185.07316504))',3035))



-- amenities
select * from amenities_not_in_buildings bwa
where st_intersects(ST_GeomFromText(ST_GeomFromText('POLYGON((4281997.41869224 2732185.07316504,4281998.88075016 2732195.14230024,4281998.01576282 2732213.92516569,4281993.61512521 2732232.20571892,4281985.83757831 2732249.32453903,4281974.9636758 2732264.66411145,4281961.38566396 2732277.67110312,4281945.59333238 2732287.87632242,4281928.15634618 2732294.91164401,4281909.70369689 2732298.52328794,4281899.89836158 2732299.48902918,4281899.80062908 2732299.51867601,4281899.71055828 2732299.56681985,4281899.63161057 2732299.63161056,4281899.56681985 2732299.71055828,4281899.51867601 2732299.80062907,4281899.48902918 2732299.89836158,4281899 2732304.86355813,4281899 2732400,4281897.32744326 2732418.12094891,4281892.36628708 2732435.62960862,4281884.28416412 2732451.93437859,4281873.35416141 2732466.48433653,4281859.9455931 2732478.78785356,4281844.51152164 2732488.42920582,4281827.57344925 2732495.08262142,4281809.70369689 2732498.52328794,4281799.89836158 2732499.48902918,4281799.80062908 2732499.51867601,4281799.71055828 2732499.56681985,4281799.63161057 2732499.63161056,4281799.56681985 2732499.71055828,4281799.51867601 2732499.80062907,4281799.48902918 2732499.89836158,4281799 2732504.86355813,4281799 2732595.13644187,4281799.48902918 2732600.10163842,4281799.51867601 2732600.19937093,4281799.56681985 2732600.28944172,4281799.63161057 2732600.36838944,4281799.71055828 2732600.43318015,4281799.80062908 2732600.48132399,4281799.89836158 2732600.51097082,4281804.86355813 2732601,4281895.13644187 2732601,4281900.10163842 2732600.51097082,4281905.52122057 2732598.86695855,4281911.05481399 2732596.52729832,4281928.59387086 2732592.63659849,4281946.54726737 2732591.97962414,4281964.32378142 2732594.57801004,4281976.90843708 2732598.84446971,4281979.1233037 2732599.34140188,4281979.22510906 2732599.34381457,4281983.25367623 2732598.63851471,4281986.23346757 2732597.64747867,4282050.98250327 2732572.50907546,4282052.67774805 2732571.81526867,4282054.35848586 2732571.09153676,4282056.02745182 2732570.33670197,4282088.89368292 2732554.74796176,4282092.06044497 2732553.10647598,4282095.15571594 2732551.36064439,4282098.19866948 2732549.49965245,4282146.71482044 2732517.41992253,4282163.72714343 2732508.41445931,4282182.16056123 2732502.87130051,4282201.31821599 2732501,4282295.13644187 2732501,4282300.10163842 2732500.51097082,4282300.19937092 2732500.48132399,4282300.28944172 2732500.43318015,4282300.36838943 2732500.36838944,4282300.43318015 2732500.28944172,4282300.48132399 2732500.19937093,4282300.51097082 2732500.10163842,4282301 2732495.13644187,4282301 2732494.32793279,4282303.03682233 2732474.34938989,4282309.06347831 2732455.19292259,4282318.83198354 2732437.6467798,4282331.9403843 2732422.43294888,4282347.84929708 2732410.17744743,4282365.90410312 2732401.38456392,4282385.3618846 2732396.41610726,4282405.42199416 2732395.47651914,4282425.25899991 2732398.60446167,4282444.0566502 2732405.67122648,4282449.67425281 2732408.46281173,4282449.77100851 2732408.48861632,4282453.94272214 2732408.73951837,4282457.16272239 2732408.44779934,4282577.86753831 2732391.37758309,4282581.11134693 2732390.74380087,4282585.17543061 2732389.25874244,4282585.25573357 2732389.20837591,4282585.32378301 2732389.14238633,4282585.37659329 2732389.06366895,4282585.41184738 2732388.97567747,4282586.14909619 2732384.71203595,4282586.19482672 2732381.40720873,4282581.60244345 2732262.57045071,4282582.53680519 2732244.65468309,4282586.68904681 2732227.20169909,4282593.92281594 2732210.78462428,4282598.15490424 2732204.55179615,4282600.48132399 2732200.19937093,4282600.51097082 2732200.10163842,4282601 2732195.13644187,4282601 2732104.86355813,4282600.51097082 2732099.89836158,4282600.48132399 2732099.80062907,4282600.43318015 2732099.71055828,4282600.36838943 2732099.63161056,4282600.28944172 2732099.56681985,4282600.19937092 2732099.51867601,4282600.10163842 2732099.48902918,4282595.13644187 2732099,4282504.86355813 2732099,4282499.89836158 2732099.48902918,4282499.80062908 2732099.51867601,4282499.71055828 2732099.56681985,4282499.63161057 2732099.63161056,4282499.56681985 2732099.71055828,4282499.51867601 2732099.80062907,4282498.35223764 2732103.64586105,4282495.68536327 2732116.63952152,4282487.45377848 2732135.52967954,4282475.4900696 2732152.30664972,4282460.31252617 2732166.24362334,4282442.57866683 2732176.73682548,4282423.05675446 2732183.33167163,4282415.8951919 2732184.94459055,4282411.41722228 2732186.84480967,4282402.2575052 2732191.66318818,4282383.91324626 2732197.14848334,4282364.85616923 2732199,4282304.86355813 2732199,4282299.89836158 2732199.48902918,4282299.80062908 2732199.51867601,4282299.71055828 2732199.56681985,4282299.63161057 2732199.63161056,4282294.90222514 2732205.39438339,4282281.00817311 2732219.25746108,4282264.65228409 2732230.10709237,4282246.47742844 2732237.51683104,4282227.1979713 2732241.19543635,4282207.57169427 2732240.99832021,4282188.37001077 2732236.93323032,4282170.34764553 2732229.15994555,4282154.21297 2732217.98399591,4282140.60015974 2732203.84465357,4282130.04426807 2732187.29766726,4282122.9601957 2732168.99341848,4282117.39278732 2732148.8749034,4282116.37935611 2732145.8336756,4282114.43388927 2732142.06657956,4282114.37280666 2732141.99157426,4282114.29762866 2732141.93070433,4282114.21155693 2732141.88656208,4282114.11825708 2732141.86102743,4282114.02170253 2732141.85518784,4282109.82721968 2732142.47338469,4282106.76606956 2732143.42494621,4282073.36180495 2732155.73464355,4282070.54683642 2732156.92501199,4282067.17110368 2732158.95342197,4282065.9512084 2732160.04307885,4282050.6794854 2732171.25385801,4282033.55190822 2732179.35035063,4282015.19567907 2732184.03606773,4281997.41869224 2732185.07316504))',3035), bwa.geometry)


-- ways
select wws.* from ways_with_segments_3035 wws
WHERE st_intersects(ST_GeomFromText('POLYGON((4281997.41869224 2732185.07316504,4281998.88075016 2732195.14230024,4281998.01576282 2732213.92516569,4281993.61512521 2732232.20571892,4281985.83757831 2732249.32453903,4281974.9636758 2732264.66411145,4281961.38566396 2732277.67110312,4281945.59333238 2732287.87632242,4281928.15634618 2732294.91164401,4281909.70369689 2732298.52328794,4281899.89836158 2732299.48902918,4281899.80062908 2732299.51867601,4281899.71055828 2732299.56681985,4281899.63161057 2732299.63161056,4281899.56681985 2732299.71055828,4281899.51867601 2732299.80062907,4281899.48902918 2732299.89836158,4281899 2732304.86355813,4281899 2732400,4281897.32744326 2732418.12094891,4281892.36628708 2732435.62960862,4281884.28416412 2732451.93437859,4281873.35416141 2732466.48433653,4281859.9455931 2732478.78785356,4281844.51152164 2732488.42920582,4281827.57344925 2732495.08262142,4281809.70369689 2732498.52328794,4281799.89836158 2732499.48902918,4281799.80062908 2732499.51867601,4281799.71055828 2732499.56681985,4281799.63161057 2732499.63161056,4281799.56681985 2732499.71055828,4281799.51867601 2732499.80062907,4281799.48902918 2732499.89836158,4281799 2732504.86355813,4281799 2732595.13644187,4281799.48902918 2732600.10163842,4281799.51867601 2732600.19937093,4281799.56681985 2732600.28944172,4281799.63161057 2732600.36838944,4281799.71055828 2732600.43318015,4281799.80062908 2732600.48132399,4281799.89836158 2732600.51097082,4281804.86355813 2732601,4281895.13644187 2732601,4281900.10163842 2732600.51097082,4281905.52122057 2732598.86695855,4281911.05481399 2732596.52729832,4281928.59387086 2732592.63659849,4281946.54726737 2732591.97962414,4281964.32378142 2732594.57801004,4281976.90843708 2732598.84446971,4281979.1233037 2732599.34140188,4281979.22510906 2732599.34381457,4281983.25367623 2732598.63851471,4281986.23346757 2732597.64747867,4282050.98250327 2732572.50907546,4282052.67774805 2732571.81526867,4282054.35848586 2732571.09153676,4282056.02745182 2732570.33670197,4282088.89368292 2732554.74796176,4282092.06044497 2732553.10647598,4282095.15571594 2732551.36064439,4282098.19866948 2732549.49965245,4282146.71482044 2732517.41992253,4282163.72714343 2732508.41445931,4282182.16056123 2732502.87130051,4282201.31821599 2732501,4282295.13644187 2732501,4282300.10163842 2732500.51097082,4282300.19937092 2732500.48132399,4282300.28944172 2732500.43318015,4282300.36838943 2732500.36838944,4282300.43318015 2732500.28944172,4282300.48132399 2732500.19937093,4282300.51097082 2732500.10163842,4282301 2732495.13644187,4282301 2732494.32793279,4282303.03682233 2732474.34938989,4282309.06347831 2732455.19292259,4282318.83198354 2732437.6467798,4282331.9403843 2732422.43294888,4282347.84929708 2732410.17744743,4282365.90410312 2732401.38456392,4282385.3618846 2732396.41610726,4282405.42199416 2732395.47651914,4282425.25899991 2732398.60446167,4282444.0566502 2732405.67122648,4282449.67425281 2732408.46281173,4282449.77100851 2732408.48861632,4282453.94272214 2732408.73951837,4282457.16272239 2732408.44779934,4282577.86753831 2732391.37758309,4282581.11134693 2732390.74380087,4282585.17543061 2732389.25874244,4282585.25573357 2732389.20837591,4282585.32378301 2732389.14238633,4282585.37659329 2732389.06366895,4282585.41184738 2732388.97567747,4282586.14909619 2732384.71203595,4282586.19482672 2732381.40720873,4282581.60244345 2732262.57045071,4282582.53680519 2732244.65468309,4282586.68904681 2732227.20169909,4282593.92281594 2732210.78462428,4282598.15490424 2732204.55179615,4282600.48132399 2732200.19937093,4282600.51097082 2732200.10163842,4282601 2732195.13644187,4282601 2732104.86355813,4282600.51097082 2732099.89836158,4282600.48132399 2732099.80062907,4282600.43318015 2732099.71055828,4282600.36838943 2732099.63161056,4282600.28944172 2732099.56681985,4282600.19937092 2732099.51867601,4282600.10163842 2732099.48902918,4282595.13644187 2732099,4282504.86355813 2732099,4282499.89836158 2732099.48902918,4282499.80062908 2732099.51867601,4282499.71055828 2732099.56681985,4282499.63161057 2732099.63161056,4282499.56681985 2732099.71055828,4282499.51867601 2732099.80062907,4282498.35223764 2732103.64586105,4282495.68536327 2732116.63952152,4282487.45377848 2732135.52967954,4282475.4900696 2732152.30664972,4282460.31252617 2732166.24362334,4282442.57866683 2732176.73682548,4282423.05675446 2732183.33167163,4282415.8951919 2732184.94459055,4282411.41722228 2732186.84480967,4282402.2575052 2732191.66318818,4282383.91324626 2732197.14848334,4282364.85616923 2732199,4282304.86355813 2732199,4282299.89836158 2732199.48902918,4282299.80062908 2732199.51867601,4282299.71055828 2732199.56681985,4282299.63161057 2732199.63161056,4282294.90222514 2732205.39438339,4282281.00817311 2732219.25746108,4282264.65228409 2732230.10709237,4282246.47742844 2732237.51683104,4282227.1979713 2732241.19543635,4282207.57169427 2732240.99832021,4282188.37001077 2732236.93323032,4282170.34764553 2732229.15994555,4282154.21297 2732217.98399591,4282140.60015974 2732203.84465357,4282130.04426807 2732187.29766726,4282122.9601957 2732168.99341848,4282117.39278732 2732148.8749034,4282116.37935611 2732145.8336756,4282114.43388927 2732142.06657956,4282114.37280666 2732141.99157426,4282114.29762866 2732141.93070433,4282114.21155693 2732141.88656208,4282114.11825708 2732141.86102743,4282114.02170253 2732141.85518784,4282109.82721968 2732142.47338469,4282106.76606956 2732143.42494621,4282073.36180495 2732155.73464355,4282070.54683642 2732156.92501199,4282067.17110368 2732158.95342197,4282065.9512084 2732160.04307885,4282050.6794854 2732171.25385801,4282033.55190822 2732179.35035063,4282015.19567907 2732184.03606773,4281997.41869224 2732185.07316504))',3035), wws.geometry)


select bwa.*
from buildings_with_amenities bwa
where bwa.osm_id = 8648639314




-- check  9.4341 47.6718, 9.4341 47.6790, 9.4467 47.6790, 9.4467 47.6718, 9.4341 47.6718

-- ways
select wws.* from ways_with_segments wws
WHERE st_intersects(ST_GeomFromText('POLYGON ((9.4341 47.6718, 9.4341 47.6790, 9.4467 47.6790, 9.4467 47.6718, 9.4341 47.6718))', 4326),
                    wws.geometry)

